

@using Report.BLL;
@using Report.DO;
@using Report.Web;
@using ReportViewerForMvc


@{
    Layout = "~/Views/Shared/MainLayout.cshtml";
}
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>ProfitLossReport</title>


  
    <script src="~/libs/DataTables/jquery.dataTables.js"></script>
    <script src="~/libs/DataTables/jquery.dataTables.min.js"></script>
    <script src="~/libs/DataTables/dataTables.rowGroup.min.js"></script>
    
    
    
    <script src="~/libs/DataTables/dataTables.buttons.min.js"></script>
    <script src="~/libs/DataTables/buttons.flash.min.js"></script>
    <script src="~/libs/DataTables/buttons.html5.min.js"></script>
    <script src="~/libs/DataTables/buttons.print.min.js"></script>
    <script src="~/libs/jszip.min.js"></script>
    <script src="~/libs/pdfmake.js"></script>
    <script src="~/libs/vfs_fonts.js"></script>


    <script src="~/Scripts/ProfitLossReport.js?v30"></script>
    <link href="~/Css/dataTables.css" rel="stylesheet" />
    <style>
        /*//this datalist form wehn grouping width datalist set for sorting icon width issue*/
       table.dataTable
       {
           width:2644px !important;

       }
       .summry.table.dataTable
       {
            width: 50% !important;
            float: left;
       }
    </style>
</head>

<body ng-app="Profitlossreportapp" ng-controller="ProfitlossreportCntr" id="MainWrap" style="overflow-x: auto;">

    <input type="hidden" id="hdnParentmemberid" value="" />
    <input type="hidden" id="hdnParenttypeid" value="" />
    <input type="hidden" id="hdnsearchtype" value="@TempData["SearchType"]" />
    <input type="hidden" id="hdnFilterKey" value="@ViewBag.FilterKey" />
    <input type="hidden" id="hdnRptParam" value="@ViewBag.RptSearch" />

    <div id="MainBody" runat="server" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 nopadding">

        <div id="HeaderSearchdiv" class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-12 col-xs-12 container mrg-top40">
            <div class="col-lg-12 col-md-12  col-sm-12 col-xs-12 mtb10 hdbg bdr1 bdr-btm0 padd-btm5 padd-top5" id="divhdeading">
                <div class="col-lg-8 col-md-8  col-sm-8 col-xs-12">
                    <span style="font-size: 17px;font-weight: 600;">Profit And Loss Report</span><br />

                    <div id="RptHeaderDetails" style="display:none;">
                        <b>From: </b><span id="spDateFrom">{{ProfitLossReport.DateFrom}}</span>&nbsp;
                        <b>To: </b><span id="spDateTo">{{ProfitLossReport.DateTo}}</span>&nbsp;
                        <span>
                            <span ng-if="ReportFilter.GroupBy!=''"><b>View By:</b> </span> <span>{{GroupingName}} </span>
                        </span>
                        <label ng-if="LoginMemberType != '4'"><b>Showing Report For :</b> <span id="spBrchName" style="font-weight: normal !important">{{PostBooking.ReportCompanyName}}</span></label>
                    </div>
                </div>
                <div class="col-lg-4 col-md-4  col-sm-4 col-xs-12">
                    <span ng-hide="ModifySearch" class="pull-right mrg-top05" id="modifyserach">
                        <a id="btnModifySearch" ng-click="ShowModifyClick()" class="btn search hover-btn" data-toggle="collapse" data-target="#demo"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> &nbsp;Modify search </a>
                    </span>
                </div>
            </div>

            <form class="col-lg-12 col-md-12 col-sm-12 col-xs-12 whitebg2 collapse  bdr1 bdr-top0" id="demo" style="box-shadow:none !important;">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mrg-btm10 nopadding">
                    <ul class="nav nav-tabs nobdr mrg-top05">
                        <li id="Arrivalwise" class="radio-inline nomargin padd-lft10">
                            <label class="radio-inline"><input type="radio" id="ADW" autocomplete="off" name="Booking" text="Arrivaldate wise" value="1" class="mrg-lft0" checked="checked">Service Date Wise</label>
                        </li>
                        <li id="BookDatewise" class="radio-inline nomargin">
                            <label class="radio-inline"><input type="radio" id="BDW" autocomplete="off" name="Booking" text="Bookdate wise" value="0" class="mrg-lft0">Booking Date Wise</label>
                        </li>
                        <li id="RRdatewise" class="radio-inline nomargin">
                            <label class="radio-inline"><input type="radio" id="RDW" autocomplete="off" name="Booking" text="RRdate wise" value="2" class="mrg-lft0">RR Date Wise</label>
                        </li>
                    </ul>

                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mrg-btm10 nopadding">

                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 mrg-top20">

                        <select class="select--hoshi" id="ddl_CustomDateRange" (input)="ReportFilter.CustomDateOption=$event.target.value">
                            <option value="">Custom Date Range</option>


                            <option ng-selected="ReportFilter.CustomDateOption == dd.Values" value="{{dd.Values}}" ng-repeat="dd in DateRangeList">
                                {{dd.Name}}
                            </option>
                        </select>



                    </div>

                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 mrg-top20">
                        <input class="floating-inpt date-cal " type="text" autocomplete="off" required="" ng-model="ProfitLossReport.DateFrom" id="txtFromDate">
                        <span class="floating-label" id="spArrivalFromDate"> From Date <span class="red-color">*</span></span>

                    </div>
                    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12 mrg-top20">

                        <input class="floating-inpt date-cal " type="text" autocomplete="off" required="" ng-model="ProfitLossReport.DateTo" id="txtToDate">
                        <span class="floating-label" id="spArrivalToDate"> To Date <span class="red-color">*</span></span>

                    </div>

                    <div ng-controller="PostBookingController" class="col-lg-12 col-md-12 col-sm-12 col-xs-12 nopadding">
                        <input type="hidden" id="hdnIsGetMemberdetails" value="" />
                        <input type="hidden" id="hdnMemberdetails" value="" />
                        @{
                            Html.RenderPartial("PostBookingPartial");
                        }

                    </div>
                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mrg-top30">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 nopadding pstbkng">
                        <h4>Advance Search</h4>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 mrg-btm20 mrg-top20">
                            <label>
                                Report View By  :
                            </label>
                            <select class="select--hoshi" id="ddl_Grp">

                                <option value="">None</option>
                                <option ng-show="LoginMemberType == '2' ? false : true"  ng-selected="ReportFilter.GroupBy == '1'" value="1~Branch Name">By Branch</option>
                                @*<option  ng-show="LoginMemberType == '4' ? false : true" ng-selected="ReportFilter.GroupBy == '2'" value="2~Agency Name">By Agency</option>*@
                                <option ng-selected="ReportFilter.GroupBy == '28'" value="28~Booking Status">By Booking Status</option>
                                <option ng-selected="ReportFilter.GroupBy == '7'" value="7~Service Type">By Service Type</option>
                                <option ng-show="IsShowSupplier == 'false' ? false : true" ng-selected="ReportFilter.GroupBy == '5'" value="5~Supplier">By Supplier</option>
                            </select>



                        </div>

                    </div>
                </div>



                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mrg-top20 mrg-btm10 nopadding">
                    <div class="col-md-12 text-left mtb10">
                        <div class="upt-prof-btn">
                            <a class="btn hover-btn nomargin" ng-click="SearchReportClick()" data-toggle="collapse" data-target="#demo">Search</a>
                            <a id="btnclose" class="btn search hover-btn" ng-click="ShowModifyBtn();" data-toggle="collapse" data-target="#demo"> &nbsp;Close </a>

                        </div>
                    </div>
                </div>
            </form>

        </div>

       
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mrg-top20" style="display:none;" id="RptDetails">

            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 whitebg" style="width: auto;">

              
                
                <table id="ProfitLossReport" class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs display nowrap " style="width:2644px !important; font-size:13px;padding: 5px 5px !important;">
                    <thead class="main-head hidden-xs" id="theaddiv">
                        <tr>
                            @*//its complusaory for give <dialog> tag with col id for all th bcz for top show col sorting this id is must*@
                            <th>Book Ref / Pos </th>
                            <th ng-show="LoginMemberType == '2' || ReportFilter.GroupBy.split('~')[0] =='1' ? false : true">Branch Name <a class="filter-icon" id="BrName" onclick="CalltoFilterPopup('BrName')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th ng-show="LoginMemberType ==  '4' || ReportFilter.GroupBy.split('~')[0] =='2' ? false : true">WS / Ag Name <a class="filter-icon" id="AgName" onclick="CalltoFilterPopup('AgName')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th ng-show="LoginMemberType ==  '4' ? false : true">WS / Ag City <a class="filter-icon" id="AgCity" onclick="CalltoFilterPopup('AgCity')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th ng-show="LoginMemberType ==  '4' ? false : true">WS / Ag Country <a class="filter-icon" id="AgCountry" onclick="CalltoFilterPopup('AgCountry')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>

                            <th ng-show="ReportFilter.GroupBy.split('~')[0] =='5' || IsShowSupplier == 'false' ? false : true">Supplier Name <a class="filter-icon" id="SuppName" onclick="CalltoFilterPopup('SuppName')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Service Name <a class="filter-icon" id="SName"></a></th>
                            <th>Department Name<a class="filter-icon" id="DeptName" onclick="CalltoFilterPopup('DeptName')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>

                            <th ng-show="ReportFilter.GroupBy.split('~')[0] =='7' ? false : true">Service <a class="filter-icon" id="SType" onclick="CalltoFilterPopup('SType')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Service City <a class="filter-icon" id="SCity" onclick="CalltoFilterPopup('SCity')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Service Country<a class="filter-icon" id="SCountry" onclick="CalltoFilterPopup('SCountry')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>

                            <th>Booked By <a class="filter-icon" id="BookedBy" onclick="CalltoFilterPopup('BookedBy')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>

                            <th>Source <a class="filter-icon" id="BType" onclick="CalltoFilterPopup('BType')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Inbound / Outbound <a class="filter-icon" id="IsInbound" onclick="CalltoFilterPopup('IsInbound')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Invoiced (Y / N) <a class="filter-icon" id="Invoiced" onclick="CalltoFilterPopup('Invoiced')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Book Date</th>
                            <th>Check In Date</th>
                            <th>Nights  <a class="filter-icon" id="Nts" onclick="CalltoFilterPopup('Nts')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Net Currency <a class="filter-icon" id="NetCur" onclick="CalltoFilterPopup('NetCur')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Net Amt <a class="filter-icon" id="SNetAmt" onclick="CalltoFilterPopup('SNetAmt')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Sell Currency <a class="filter-icon" id="SellCur" onclick="CalltoFilterPopup('SellCur')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>HQ Extra Quoted  <a class="filter-icon" id="HQExtra"></a></th>
                            <th>BR Extra Quoted  <a class="filter-icon" id="BRExtra"></a></th>
                            <th>WS / Ag Payable  <a class="filter-icon" id="AGPay" onclick="CalltoFilterPopup('AGPay')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Tax  <a class="filter-icon" id="TaxPay" onclick="CalltoFilterPopup('TaxPay')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Net (Sell Currency)  <a class="filter-icon" id="SSNetAmt" onclick="CalltoFilterPopup('SSNetAmt')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>

                            <th>Convenience Fee <a class="filter-icon" id="ConFee" style="display:none;"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Profit Amount <a class="filter-icon" id="ProfitAmt" onclick="CalltoFilterPopup('ProfitAmt')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>Profit (%) <a class="filter-icon" id="Profit" onclick="CalltoFilterPopup('Profit')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th ng-show="ReportFilter.GroupBy.split('~')[0] =='24' ? false : true">Status <a class="filter-icon" id="Status" onclick="CalltoFilterPopup('Status')"><i class="fa fa-filter" aria-hidden="true"></i></a></th>
                            <th>RR Date</th>


                        </tr>

                    </thead>



                </table>


            </div>
        </div>


        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mrg-top20" style="display:none;" id="RptSummary">

            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 whitebg"  >
                
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mrg-btm10 nopadding" style="display:none;">
                   
                    <ul class="nav nav-tabs nobdr mrg-top05">
                        <li>
                            <span class="padd-lft10"> Report Summary Show By:</span>
                        </li>
                        <li id="Agent" class="radio-inline nomargin padd-lft10">
                            <label class="radio-inline" for="Ag"><input type="radio" id="Ag" autocomplete="off" name="Summary" text="Agency Name" value="AgName" class="mrg-lft0" checked="checked">Agency</label>
                        </li>
                        <li id="status" class="radio-inline nomargin">
                            <label class="radio-inline" for="St"><input type="radio" id="St" autocomplete="off" name="Summary" text="Booking Status" value="Status" class="mrg-lft0">Booking Status</label>
                        </li>
                        <li id="status" class="radio-inline nomargin">
                            <label class="radio-inline" for="Sp"><input type="radio" id="Sp" autocomplete="off" name="Summary" text="Supplier" value="SuppName" class="mrg-lft0">Supplier</label>
                        </li>
                        <li id="status" class="radio-inline nomargin">
                            <label class="radio-inline" for="Ser"><input type="radio" id="Ser" autocomplete="off" name="Summary" text="Service" value="SType" class="mrg-lft0">Service</label>
                        </li>
                        <li id="status" class="radio-inline nomargin">
                            <label class="radio-inline" for="On"><input type="radio" id="On" autocomplete="off" name="Summary" text="Source" value="BType" class="mrg-lft0">Source(Online/Offline)</label>
                        </li>
                        <li id="status" class="radio-inline nomargin">
                            <label class="radio-inline" for="In"><input type="radio" id="In" autocomplete="off" name="Summary" text="Inbound/Outbound" value="IsInbound" class="mrg-lft0">Inbound/Outbound</label>
                        </li>
                        <li id="status" class="radio-inline nomargin">
                            <label class="radio-inline" for="Inv"><input type="radio" id="Inv" autocomplete="off" name="Summary" text="Invoice Status" value="Invoiced" class="mrg-lft0">Invoice</label>
                        </li>
                    </ul>

                </div>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12"  style="display:none;">
                    <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0" style="width:90%;" id="mailtablesumm" ng-repeat="s in Summary track by $index">
                        <tr>

                            <td style="width:65%;" colspan="2">
                                <b>{{s[0].BrName}}</b><br />
                                <span>Bookings: {{s.length}}</span>

                            </td>

                            <td style="width:15%;">
                                <a ng-click="getsummarybyservice(s,$index)" data-toggle="collapse" data-target="#ServicewiseGroup_{{$index}}"><i id="showgrpdetailicon_{{$index}}" class="fa fa-plus-square"></i> Show Details by Group</a>
                            </td>
                            <td style="width:10%;">
                                <a ng-click="getAmountDetail(s)" data-toggle="collapse" data-target="#AmoutDetail_{{$index}}"><i class="fa fa-plus-square"></i> Total Amounts</a>
                            </td>

                        </tr>
                        <tr class="collapse" id="ServicewiseGroup_{{$index}}">
                            <td colspan="4" class="padd15">
                                <span><u> Group Details By {{SummaryViewBy}}:</u>  </span>
                                <ng-template>
                                    @*<table  class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" >
                                <tr ng-repeat="s2 in GroupbyService">
                                    <td>
                                        {{s2[0].SType}}
                                    </td>
                                    <td>
                                        {{s2.length}}
                                    </td>
                                    <td>---------------</td>
                                </tr>

                            </table>*@
                                    <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" style="font-size:13px;" ng-repeat="f in GroupList" id="finalgroup">
                                        <tr>
                                            <td colspan="2">
                                                {{SummaryViewBy}}  &nbsp;:   {{f.Type}}    &nbsp;&nbsp; ( Bookings:  {{f.BookingCount}} )
                                            </td>


                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <ng-template>
                                                    <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" style="font-size:13px;" ng-repeat="f2 in f.AmountList">
                                                        <tr>
                                                            <td colspan="7">Net Currency: {{f2.NetCurrency}}  &nbsp;&nbsp; (Bookings: {{f2.BookingCount}})</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Net Amt</td>
                                                            <td>HQ Extra Quoted</td>
                                                            <td>BR Extra Quoted</td>
                                                            <td>WS / Ag Pay</td>
                                                            <td>Tax</td>
                                                            <td>Net (Sell Currency)</td>
                                                            <td>Profit Amt</td>
                                                        </tr>
                                                        <tr>

                                                            <td>
                                                                {{f2.TotalSNetAmt}}
                                                            </td>
                                                            <td>
                                                                {{f2.TotalHQExtra}}
                                                            </td>
                                                            <td>
                                                                {{f2.TotalBRExtra}}
                                                            </td>
                                                            <td>
                                                                {{f2.TotalAgPAy}}
                                                            </td>
                                                            <td>
                                                                {{f2.TotalTaxPay}}
                                                            </td>

                                                            <td>
                                                                {{f2.TotalSNetAmtInSell}}
                                                            </td>

                                                            <td>
                                                                {{f2.TotalProfitAmt}}
                                                            </td>

                                                        </tr>

                                                    </table>
                                                </ng-template>
                                            </td>
                                        </tr>

                                    </table>
                                </ng-template>

                            </td>
                        </tr>
                        <tr class="table collapse" id="AmoutDetail_{{$index}}">
                            <td colspan="4" class="padd15">
                                <span> <u>Total Amounts Details:</u> </span>
                                <ng-template>
                                    <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" style="font-size:13px;" ng-repeat="s3 in TotalAmountList">
                                        <tr>
                                            <td colspan="7">Net Currency: {{s3.NetCurrency}}  &nbsp;&nbsp; (Bookings: {{s3.BookingCount}})</td>
                                        </tr>
                                        <tr>
                                            <td>Net Amt</td>
                                            <td>HQ Extra Quoted</td>
                                            <td>BR Extra Quoted</td>
                                            <td>WS / Ag Pay</td>
                                            <td>Tax</td>
                                            <td>Net (Sell Currency)</td>
                                            <td>Profit Amt</td>
                                        </tr>
                                        <tr>

                                            <td>
                                                {{s3.TotalSNetAmt}}
                                            </td>
                                            <td>
                                                {{s3.TotalHQExtra}}
                                            </td>
                                            <td>
                                                {{s3.TotalBRExtra}}
                                            </td>
                                            <td>
                                                {{s3.TotalAgPAy}}
                                            </td>
                                            <td>
                                                {{s3.TotalTaxPay}}
                                            </td>

                                            <td>
                                                {{s3.TotalSNetAmtInSell}}
                                            </td>

                                            <td>
                                                {{s3.TotalProfitAmt}}
                                            </td>

                                        </tr>

                                    </table>
                                </ng-template>

                            </td>
                        </tr>
                    </table>
                </div>



                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 " style="display:none;">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <a  class="btn search hover-btn"  ng-click="backtoreport()" style="padding: 8px 10px;font-size: 9px;">Report View</a>
                    </div>

                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 mrg-top05">
                            <b>Group By Branch </b><br />
                            <a class="dropdown-item" style="cursor:pointer" ng-style="Totaldiv === true ? { 'font-weight':'600'} : {  }" ng-click="GetSummary2()">Total Amounts Details</a><br />
                            <a class="dropdown-item" style="cursor:pointer" ng-style="TopfiveBr === true ? { 'font-weight':'600'} : {  }" ng-click="getTopfiveBrList()">Top 5 Branch by Selling</a><br />
                            <a class="dropdown-item" style="cursor:pointer" ng-style="sourcewisegrp === true ? { 'font-weight':'600'} : {  }" ng-click="GetProfitbyAg()">Profit by Source</a><br />
                            <a class="dropdown-item" style="cursor:pointer" ng-style="Statusgrp === true ? { 'font-weight':'600'} : {  }" ng-click="GetStatuswithSource()">Selling by Status with Source</a><br />
                            <a class="dropdown-item" style="cursor:pointer" ng-style="servicewisegrp === true ? { 'font-weight':'600'} : {  }" ng-click="GetSuppNetbyService()"> Supp.Net by Service type</a>  <br />
                            <br />

                            <b>Group By Supplier </b><br />
                            <a class="dropdown-item" style="cursor:pointer" ng-style="TotalSuppdiv === true ? { 'font-weight':'600'} : {  }" ng-click="GetSuppliertotal()">Total Amounts Details</a><br />
                            <a class="dropdown-item" style="cursor:pointer" ng-style="TopfiveSupp === true ? { 'font-weight':'600'} : {  }" ng-click="getTopfiveSuppList()">Top 5 Suppliers by Sell</a><br />
                            <br />

                            <b>Group By Invoiced </b><br />
                            <a class="dropdown-item" style="cursor:pointer">Total  Invoice Booking Amounts Details</a><br />
                            <a class="dropdown-item" style="cursor:pointer">Invoice Amount by Br</a><br />
                            <a class="dropdown-item" style="cursor:pointer">Invoice Amount by Service</a><br />
                            <br />

                            <b>Group By Inbound/Outbound </b><br />
                            <a class="dropdown-item" style="cursor:pointer">Total Booking Amounts Details</a><br />
                            <a class="dropdown-item" style="cursor:pointer">Amount by Status</a><br />
                            <br />

                            <b>Group By Services </b><br />
                            <a class="dropdown-item" style="cursor:pointer">Total Booking Amounts Details</a><br />
                            <a class="dropdown-item" style="cursor:pointer">Amount by Status</a><br />
                            <a class="dropdown-item" style="cursor:pointer">Amount by Extra quoted </a><br />

                           


                        </div>
                        <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12" id="BRDiv" ng-show="BRDivShow">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="TotalAmount" ng-show="Totaldiv">
                                <span> Branch Total Amount Details</span>
                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0 summary" style="width:90%;font-size:15px;">
                                    <tr ng-repeat="a in BRFinaList track by $index">
                                         <td colspan="2" style="border-bottom: 2px solid #ab9d9d !important;">
                                            <ng-template>
                                                <b>{{a.BrName}}</b><br />
                                                (Bookings: {{a.BookingsCount}})
                                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" style="font-size:12px;" ng-repeat="b in a.BRTotalAmountList">
                                                    <tr>
                                                        <td colspan="7">Net Currency: {{b.NetCurrency}}  &nbsp;&nbsp; (Bookings: {{b.BookingCount}})</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="summarytd">Net Amt</td>
                                                        <td class="summarytd">HQ Extra Quoted</td>
                                                        <td class="summarytd">BR Extra Quoted</td>
                                                        <td class="summarytd">WS / Ag Pay</td>
                                                        <td class="summarytd">Tax</td>
                                                        <td class="summarytd">Net (Sell Currency)</td>
                                                        <td class="summarytd">Profit Amt</td>
                                                    </tr>
                                                    <tr>

                                                        <td>
                                                            {{b.TotalSNetAmt}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalHQExtra}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalBRExtra}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalAgPAy}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalTaxPay}}
                                                        </td>

                                                        <td>
                                                            {{b.TotalSNetAmtInSell}}
                                                        </td>

                                                        <td>
                                                            {{b.TotalProfitAmt}}
                                                        </td>

                                                    </tr>
                                                </table>
                                            </ng-template>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="TopFive" ng-show="TopfiveBr">
                                <span> Top 5 Br Amount Details ( By Bookings)</span>
                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0 summary" style="width:90%;font-size:15px;">
                                    <tr ng-repeat="a in BRFinaList track by $index">
                                        <td colspan="2" style="border-bottom: 2px solid #ab9d9d !important;">
                                            <ng-template>
                                                <b>{{a.BrName}}</b><br />
                                                (Bookings: {{a.BookingsCount}})
                                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" style="font-size:12px;" ng-repeat="b in a.BRTotalAmountList | limitTo:5">
                                                    <tr>
                                                        <td colspan="7">Net Currency: {{b.NetCurrency}}  &nbsp;&nbsp; (Bookings: {{b.BookingCount}})</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="summarytd">Net Amt</td>
                                                        <td class="summarytd">HQ Extra Quoted</td>
                                                        <td class="summarytd">BR Extra Quoted</td>
                                                        <td class="summarytd">WS / Ag Pay</td>
                                                        <td class="summarytd">Tax</td>
                                                        <td class="summarytd">Net (Sell Currency)</td>
                                                        <td class="summarytd">Profit Amt</td>
                                                    </tr>
                                                    <tr>

                                                        <td>
                                                            {{b.TotalSNetAmt}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalHQExtra}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalBRExtra}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalAgPAy}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalTaxPay}}
                                                        </td>

                                                        <td>
                                                            {{b.TotalSNetAmtInSell}}
                                                        </td>

                                                        <td>
                                                            {{b.TotalProfitAmt}}
                                                        </td>

                                                    </tr>
                                                </table>
                                            </ng-template>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="Sourcewise" ng-show="sourcewisegrp">
                                <span> Profit by Source</span>
                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0 summary" style="width:90%;font-size:15px;" ng-repeat="a1 in FinalSourceSummaryList track by $index">
                                    <tr>
                                        <td style="border-bottom: 2px solid #ab9d9d !important;">
                                            <b>{{a1.BrName}}</b> &nbsp; (Bookings: {{a1.Count}})

                                            <ng-template>
                                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0" style="width:90%;font-size:13px;" ng-repeat="a in a1.GroupList">
                                                    <tr>
                                                        <td colspan="2">
                                                            <ng-template>
                                                                <u>{{a.Type}}</u> &nbsp;(Bookings: {{a.BookingCount}})
                                                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" style="font-size:12px;">
                                                                    <tr>
                                                                        <td class="summarytd">Sell Currency</td>
                                                                        <td class="summarytd">Bookings</td>
                                                                        <td class="summarytd">Profit Amount</td>
                                                                    </tr>
                                                                    <tr ng-repeat="b in a.AmountList">
                                                                        <td>
                                                                            {{b.SellCurrency}}
                                                                        </td>
                                                                        <td>
                                                                            {{b.BookingCount}}
                                                                        </td>
                                                                        <td>
                                                                            {{b.TotalProfitAmt}}
                                                                        </td>

                                                                    </tr>
                                                                </table>
                                                            </ng-template>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </ng-template>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="StatuswithSource" ng-show="Statusgrp">
                                <span>Selling by Status with Source</span>
                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0 summary" style="width:90%;font-size:15px;" ng-repeat="a0 in FinalStatusSSummaryList track by $index">
                                    <tr>
                                        <td style="border-bottom: 2px solid #ab9d9d !important;">
                                            <b>{{a0.BrName}}</b> &nbsp; (Bookings: {{a0.BCount}})
                                            <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0" style="width:90%;font-size:13px;" ng-repeat="a1 in a0.FinalList">
                                                <tr>
                                                    <td colspan="2">
                                                        <ng-template>
                                                            <b><u>{{a1.Status}}</u> &nbsp;(Bookings: {{a1.SCount}})</b>
                                                            <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0" style="width:90%;font-size:13px;" ng-repeat="a in a1.SourceGroupList">
                                                                <tr>
                                                                    <td colspan="2">
                                                                        <ng-template>
                                                                            <u>{{a.Type}}</u> &nbsp;(Bookings: {{a.TCount}})
                                                                            <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" style="font-size:12px;">
                                                                                <tr>
                                                                                    <td class="summarytd">Source</td>
                                                                                    <td class="summarytd">Sell Currency</td>
                                                                                    <td class="summarytd">Bookings</td>
                                                                                    <td class="summarytd">Supplier Net Amount in (Sell)</td>
                                                                                </tr>
                                                                                <tr ng-repeat="b in a.AmountList">
                                                                                    <td>
                                                                                        {{a.Type}}
                                                                                    </td>
                                                                                    <td>
                                                                                        {{b.SellCurrency}}
                                                                                    </td>
                                                                                    <td>
                                                                                        {{b.BookingCount}}
                                                                                    </td>
                                                                                    <td>
                                                                                        {{b.TotalSNetAmtInSell}}
                                                                                    </td>

                                                                                </tr>
                                                                            </table>
                                                                        </ng-template>
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        </ng-template>

                                                    </td>
                                                </tr>
                                            </table>

                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="Servicewise" ng-show="servicewisegrp">
                                <span> Supplier Net By Service</span>
                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0 summary" style="width:90%;font-size:15px;" ng-repeat="a1 in FinalServiceSummaryList track by $index">
                                    <tr>
                                        <td style="border-bottom: 2px solid #ab9d9d !important;">
                                            <b>{{a1.BrName}}</b> &nbsp; (Bookings: {{a1.Count}})

                                            <ng-template>
                                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0" style="width:90%;font-size:13px;" ng-repeat="a in a1.GroupList">
                                                    <tr>
                                                        <td colspan="2">
                                                            <ng-template>
                                                                <u>{{a.Type}}</u> &nbsp;(Bookings: {{a.BookingCount}})
                                                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" style="font-size:12px;">
                                                                    <tr>
                                                                        <td class="summarytd">Net Currency</td>
                                                                        <td class="summarytd">Bookings</td>
                                                                        <td class="summarytd">Supplier Net </td>
                                                                    </tr>
                                                                    <tr ng-repeat="b in a.AmountList">
                                                                        <td>
                                                                            {{b.NetCurrency}}
                                                                        </td>
                                                                        <td>
                                                                            {{b.BookingCount}}
                                                                        </td>
                                                                        <td>
                                                                            {{b.TotalSNetAmt}}
                                                                        </td>

                                                                    </tr>
                                                                </table>
                                                            </ng-template>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </ng-template>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12" id="SuppDiv" ng-show="SuppDivShow">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="TotalSuppAmount" ng-show="TotalSuppdiv">
                                <span> Supplier Total  Amount Details</span>
                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0 summary" style="width:90%;font-size:15px;">
                                    <tr ng-repeat="a in SuppFinaList track by $index">
                                        <td colspan="2" style="border-bottom: 2px solid #ab9d9d !important;">
                                            <ng-template>
                                                <b>{{a.SuppName}}</b><br />
                                                (Bookings: {{a.BookingsCount}})
                                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs" style="font-size:12px;" ng-repeat="b in a.SuppTotalAmountList">
                                                    <tr>
                                                        <td colspan="7">Sell Currency: {{b.SellCurrency}}  &nbsp;&nbsp; (Bookings: {{b.BookingCount}})</td>
                                                    </tr>
                                                    <tr>
                                                        <td class="summarytd">Net Amt</td>
                                                        <td class="summarytd">HQ Extra Quoted</td>
                                                        <td class="summarytd">BR Extra Quoted</td>
                                                        <td class="summarytd">WS / Ag Pay</td>
                                                        <td class="summarytd">Tax</td>
                                                        <td class="summarytd">Net (Sell Currency)</td>
                                                        <td class="summarytd">Profit Amt</td>
                                                    </tr>
                                                    <tr>

                                                        <td>
                                                            {{b.TotalSNetAmt}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalHQExtra}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalBRExtra}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalAgPAy}}
                                                        </td>
                                                        <td>
                                                            {{b.TotalTaxPay}}
                                                        </td>

                                                        <td>
                                                            {{b.TotalSNetAmtInSell}}
                                                        </td>

                                                        <td>
                                                            {{b.TotalProfitAmt}}
                                                        </td>

                                                    </tr>
                                                </table>
                                            </ng-template>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" id="TopSuppFive" ng-show="TopfiveSupp">
                                <span> Top 5 Supplier ( By Sell)</span>
                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs mrg-btm0" style="width:90%;font-size:15px;">
                                    <tr ng-repeat="a in SuppFinaList track by $index">
                                        <td colspan="2" style="border-bottom: 2px solid #ab9d9d !important;">
                                            <ng-template>
                                                <b>{{a.SuppName}}</b><br />
                                                (Bookings: {{a.BookingsCount}})
                                                <table class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs summary" style="font-size:12px;" ng-repeat="b in a.SuppTotalAmountList">
                                                    <tr>
                                                        <td class="summarytd">Sell Currency: {{b.SellCurrency}}  &nbsp;&nbsp; (Bookings: {{b.BookingCount}})</td>
                                                        <td class="summarytd">Net (Sell Currency)</td>

                                                    </tr>
                                                    <tr>

                                                        <td></td>
                                                        <td>
                                                            {{b.TotalSNetAmtInSell}}
                                                        </td>


                                                    </tr>
                                                </table>
                                            </ng-template>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            
                        </div>

                    </div>


                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 ">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                       
                        <table id="ProfitLossReportSummary" class="table hsrrrtbl mbkngtable mbktbl tbl-block-responsive-xs summry" style="font-size:13px;padding: 5px 5px !important;width:200px !important;">
                            
                            <thead class="main-head hidden-xs">
                                <tr>
                                    <td colspan="4">
                                        <span style="font-size:14px;" class="nopadding"><b>Total Amounts By Sell Currency</b></span>
                                    </td>
                                </tr>
                                <tr>
                                    <th> Sell Currency </th>                                    
                                    <th> Agency Payable </th>
                                    <th> Tax Pay </th>
                                    <th> Net (Sell Currency) </th>
                                    <th> Convenience Fee</th>
                                    <th> Profit Amount </th>
                                    <th> Profit (%) </th>
                                    
                                  </tr>
                                </thead>
                        </table>
                    </div>
                </div>

                </div>
         </div>
                
            

            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 nopadding" id="Noresultdiv" style="display:none;"> <h4 class="text-center bold">No Results Found!</h4></div>
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 nopadding" id="Errordiv" style="display:none;"> <h4 class="text-center bold">There is Some Error for Processing Report!</h4></div>
            @{
                Html.RenderPartial("FilterPopupPartial");
            }

       


        </div>


        <script type="text/javascript">
          

            $("#txtFromDate").change(function () {
                $("#ddl_CustomDateRange")[0].selectedIndex = 0;
            });

            function changeMe(sel, id) {
                $("#" + id).show();
                sel.style.color = "#000";

            }



        </script>


</body>
</html>



